# Zig Integration Research for Simple Eiffel

## Overview

Research into Zig toolchain integration for the Simple Eiffel ecosystem, based on Eric Bezault's work with Gobo Eiffel.

## Source: Eric Bezault - Eiffel User Group (December 2024)

Eric Bezault has integrated the Zig toolchain into Gobo Eiffel 25.09 as the default C backend compiler.

### Key Findings from Eric's Thread

#### Gobo Eiffel 25.09 Uses Zig

- **Default C Backend**: Gobo Eiffel 25.09 uses `zig cc` as the default C compiler
- **Replaces GCC**: `zig cc` is used instead of `gcc` for compiling the C code generated by the Eiffel compiler
- **Bundled Distribution**: Zig comes bundled with Gobo - no separate C compiler installation required

#### Benefits Observed

| Benefit | Description |
|---------|-------------|
| **No C Compiler Install** | Zig is bundled, eliminating the need for users to install gcc/MSVC |
| **Cross-Platform** | Same toolchain works on Windows, Linux, macOS |
| **Caching Mechanism** | Zig's build cache accelerates incremental compilation |
| **Faster Rebuilds** | Eric reports "C compilation time improvements thanks to this caching mechanism" |

#### Eric's Quote on Performance

> "I saw C compilation time improvements thanks to this caching mechanism"

This is significant because Eiffel compilers generate C code, and C compilation is often the bottleneck in the build process.

### Compiler Options in Gobo Eiffel

| Compiler | Description | IDE Compatible |
|----------|-------------|----------------|
| `ec.exe` | EiffelStudio compiler | Yes |
| `ecb.exe` | Batch mode, faster | No |
| `gec.exe` | Gobo Eiffel Compiler, fastest | No |

## Implications for Simple Eiffel

### Potential Benefits

1. **Simpler Installation**
   - Currently: Users must install EiffelStudio + Visual Studio Build Tools (or gcc)
   - With Zig: Could bundle Zig with installer, eliminating C compiler requirement

2. **Faster CI/CD**
   - GitHub Actions could use Zig instead of installing MSVC
   - Caching would speed up incremental builds in CI

3. **Cross-Compilation**
   - Zig's cross-compilation capabilities could enable building Windows binaries on Linux
   - Could simplify multi-platform releases

4. **Consistent Toolchain**
   - Same C compiler on all platforms
   - Eliminates platform-specific compiler quirks

### Technical Considerations

#### How Eiffel Compilation Works

```
Eiffel Source (.e files)
        ↓
   Eiffel Compiler
        ↓
Generated C Code (.c files)
        ↓
   C Compiler (gcc/msvc/zig)
        ↓
   Executable
```

The Zig change affects the final C→Executable step.

#### Zig as C Compiler

Zig's `zig cc` is a drop-in replacement for GCC:

```bash
# Traditional
gcc -o output source.c

# With Zig
zig cc -o output source.c
```

Zig includes:
- A C compiler (Clang-based)
- A linker
- libc implementations for many platforms

### Requirements for Integration

To use Zig with EiffelStudio (not just Gobo):

1. **Configure C compiler path** in EiffelStudio settings
2. **Set appropriate flags** for Zig compatibility
3. **Test with inline C** used heavily in simple_* libraries

### Risks and Unknowns

| Risk | Mitigation |
|------|------------|
| EiffelStudio expects specific C compiler behavior | Test extensively with simple_* libraries |
| Inline C syntax differences | Zig is Clang-based, should be compatible |
| Windows API headers | Zig bundles Windows headers |
| WEL/Vision2 compatibility | May need testing |

## Next Steps

1. **Experiment**: Try configuring EiffelStudio to use `zig cc`
2. **Benchmark**: Compare build times with MSVC vs Zig
3. **Test**: Run simple_* test suites with Zig-compiled binaries
4. **Document**: Create setup guide if successful

## References

- Eric Bezault's Gobo Eiffel: https://github.com/gobo-eiffel/gobo
- Zig Language: https://ziglang.org/
- Zig as C Compiler: https://ziglang.org/learn/overview/#cc-compiler

---

*Research initiated: December 27, 2024*
*Source: Eiffel User Group mailing list thread - Eric Bezault on Gobo Eiffel 25.09*
*Produced for: Simple Eiffel ecosystem strategic planning*
